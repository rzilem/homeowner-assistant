<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manager Wizard | PS Property Management</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        :root {
            /* Brand Colors */
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --primary-light: #e0e7ff;
            --primary-glow: rgba(99, 102, 241, 0.4);

            /* Accent Colors */
            --accent-cyan: #06b6d4;
            --accent-purple: #8b5cf6;
            --accent-pink: #ec4899;
            --accent-orange: #f97316;
            --accent-green: #10b981;

            /* Status Colors */
            --success: #10B981;
            --success-light: #D1FAE5;
            --warning: #F59E0B;
            --warning-light: #FEF3C7;
            --danger: #EF4444;
            --danger-light: #FEE2E2;
            --info: #3B82F6;
            --info-light: #DBEAFE;

            /* Neutrals */
            --gray-50: #F9FAFB;
            --gray-100: #F3F4F6;
            --gray-200: #E5E7EB;
            --gray-300: #D1D5DB;
            --gray-400: #9CA3AF;
            --gray-500: #6B7280;
            --gray-600: #4B5563;
            --gray-700: #374151;
            --gray-800: #1F2937;
            --gray-900: #111827;

            /* Glass Effect */
            --glass-bg: rgba(255, 255, 255, 0.8);
            --glass-border: rgba(255, 255, 255, 0.3);
            --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);

            /* Shadows */
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            --shadow-glow: 0 0 40px var(--primary-glow);

            /* Spacing */
            --radius: 16px;
            --radius-sm: 12px;
            --radius-lg: 24px;
            --radius-full: 9999px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            min-height: 100vh;
            color: var(--gray-800);
            line-height: 1.5;
            overflow-x: hidden;
        }

        /* Animated Gradient Background */
        .bg-gradient {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #6366f1 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            z-index: -2;
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* Floating Orbs */
        .orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(60px);
            opacity: 0.4;
            z-index: -1;
            animation: float 20s ease-in-out infinite;
        }

        .orb-1 {
            width: 400px;
            height: 400px;
            background: var(--accent-cyan);
            top: -100px;
            right: -100px;
            animation-delay: 0s;
        }

        .orb-2 {
            width: 300px;
            height: 300px;
            background: var(--accent-pink);
            bottom: -50px;
            left: -50px;
            animation-delay: -5s;
        }

        .orb-3 {
            width: 200px;
            height: 200px;
            background: var(--accent-purple);
            top: 50%;
            left: 30%;
            animation-delay: -10s;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            25% { transform: translate(30px, -30px) scale(1.1); }
            50% { transform: translate(-20px, 20px) scale(0.9); }
            75% { transform: translate(20px, 30px) scale(1.05); }
        }

        /* Header */
        .header {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: 1rem 2rem;
            border-bottom: 1px solid var(--glass-border);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 14px;
            text-decoration: none;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent-purple) 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            box-shadow: var(--shadow-lg), 0 0 20px var(--primary-glow);
            position: relative;
            overflow: hidden;
        }

        .logo-icon::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.3) 50%, transparent 70%);
            animation: shimmer 3s ease-in-out infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) rotate(45deg); }
            100% { transform: translateX(100%) rotate(45deg); }
        }

        .logo-text {
            display: flex;
            flex-direction: column;
        }

        .logo-title {
            font-weight: 800;
            font-size: 1.5rem;
            background: linear-gradient(135deg, var(--gray-900) 0%, var(--gray-700) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-subtitle {
            font-size: 0.75rem;
            color: var(--gray-500);
            font-weight: 500;
            letter-spacing: 0.05em;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 16px;
            background: var(--success-light);
            border-radius: var(--radius-full);
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--success);
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--success);
            animation: pulse 2s infinite;
            box-shadow: 0 0 10px var(--success);
        }

        .status-dot.disconnected {
            background: var(--danger);
            animation: none;
            box-shadow: 0 0 10px var(--danger);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.1); }
        }

        /* Main Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Hero Section */
        .hero {
            text-align: center;
            padding: 4rem 1rem 3rem;
            color: white;
        }

        .hero h1 {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 1rem;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            animation: heroFadeIn 0.8s ease-out;
        }

        .hero p {
            font-size: 1.25rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
            animation: heroFadeIn 0.8s ease-out 0.2s backwards;
        }

        @keyframes heroFadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Search Container */
        .search-container {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            padding: 2rem;
            box-shadow: var(--shadow-xl), var(--shadow-glow);
            margin-bottom: 2rem;
            animation: containerFadeIn 0.6s ease-out 0.3s backwards;
        }

        @keyframes containerFadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Search Mode Toggle */
        .search-mode-toggle {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 1.5rem;
        }

        .mode-btn {
            padding: 10px 20px;
            border: 2px solid var(--gray-200);
            background: white;
            border-radius: var(--radius-full);
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--gray-600);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .mode-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .mode-btn.active {
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent-purple) 100%);
            border-color: transparent;
            color: white;
            box-shadow: var(--shadow-md), 0 0 20px var(--primary-glow);
        }

        .mode-btn i {
            font-size: 1rem;
        }

        /* Search Box */
        .search-box {
            position: relative;
            margin-bottom: 1rem;
        }

        .search-input {
            width: 100%;
            padding: 1.25rem 1.25rem 1.25rem 4rem;
            font-size: 1.125rem;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius);
            transition: all 0.3s ease;
            font-family: inherit;
            background: white;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px var(--primary-light), var(--shadow-lg);
        }

        .search-input::placeholder {
            color: var(--gray-400);
        }

        .search-icon {
            position: absolute;
            left: 1.5rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray-400);
            font-size: 1.25rem;
            transition: color 0.3s ease;
        }

        .search-input:focus + .search-icon,
        .search-box:hover .search-icon {
            color: var(--primary);
        }

        .search-btn {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent-purple) 100%);
            color: white;
            border: none;
            padding: 0.875rem 1.75rem;
            border-radius: var(--radius-sm);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .search-btn:hover {
            transform: translateY(-50%) scale(1.02);
            box-shadow: var(--shadow-lg), 0 0 30px var(--primary-glow);
        }

        .search-btn:disabled {
            background: var(--gray-300);
            cursor: not-allowed;
            box-shadow: none;
        }

        /* Search Hints */
        .search-hints {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            margin-top: 1rem;
        }

        .hint-chip {
            padding: 6px 14px;
            background: var(--gray-100);
            border-radius: var(--radius-full);
            font-size: 0.8rem;
            color: var(--gray-600);
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid transparent;
        }

        .hint-chip:hover {
            background: var(--primary-light);
            color: var(--primary);
            border-color: var(--primary);
        }

        .hint-chip i {
            margin-right: 6px;
            opacity: 0.7;
        }

        /* Results Container */
        .results-container {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            padding: 2rem;
            box-shadow: var(--shadow-xl);
            min-height: 200px;
        }

        /* Results Header */
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--gray-200);
        }

        .results-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--gray-800);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .results-count {
            padding: 4px 12px;
            background: var(--primary-light);
            color: var(--primary);
            border-radius: var(--radius-full);
            font-size: 0.875rem;
            font-weight: 600;
        }

        .detected-badge {
            padding: 6px 14px;
            background: linear-gradient(135deg, var(--accent-cyan) 0%, var(--accent-purple) 100%);
            color: white;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Results Grid */
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 1.5rem;
        }

        /* AI Answer Card */
        .ai-answer-card {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 2px solid var(--accent-cyan);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }

        .ai-answer-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, var(--accent-cyan) 0%, var(--accent-purple) 100%);
        }

        .ai-answer-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 1rem;
        }

        .ai-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--accent-cyan) 0%, var(--accent-purple) 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }

        .ai-answer-title {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--gray-800);
        }

        .ai-answer-subtitle {
            font-size: 0.8rem;
            color: var(--gray-500);
        }

        .ai-answer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .ai-data-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .ai-data-label {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .ai-data-value {
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray-800);
        }

        .ai-summary {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px dashed var(--gray-300);
            font-size: 0.95rem;
            color: var(--gray-700);
            line-height: 1.6;
        }

        .ai-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 1rem;
        }

        .ai-tag {
            padding: 4px 10px;
            background: white;
            border: 1px solid var(--accent-cyan);
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            color: var(--accent-cyan);
            font-weight: 500;
        }

        /* Homeowner Card */
        .homeowner-card {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: var(--radius);
            padding: 1.5rem;
            position: relative;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .homeowner-card::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 4px;
            height: 100%;
            background: var(--primary);
            transition: width 0.3s ease;
        }

        .homeowner-card.status-owed::before {
            background: var(--danger);
        }

        .homeowner-card.status-credit::before {
            background: var(--success);
        }

        .homeowner-card.status-collections::before {
            background: linear-gradient(180deg, var(--danger) 0%, #991B1B 100%);
        }

        .homeowner-card.status-attorney {
            border: 2px solid #DC2626;
            background: linear-gradient(135deg, #FEF2F2 0%, #FEE2E2 100%);
        }

        .homeowner-card.status-attorney::before {
            background: linear-gradient(180deg, #DC2626 0%, #7C2D12 100%);
            width: 6px;
        }

        .homeowner-card:hover {
            border-color: var(--gray-300);
            box-shadow: var(--shadow-lg);
            transform: translateY(-4px);
        }

        .homeowner-card:hover::before {
            width: 6px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .card-name {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--gray-900);
        }

        .card-community {
            font-size: 0.875rem;
            color: var(--gray-500);
            margin-top: 4px;
        }

        .card-balance {
            text-align: right;
        }

        .balance-amount {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .balance-amount.balance-owed { color: var(--danger); }
        .balance-amount.balance-credit { color: var(--success); }
        .balance-amount.balance-current { color: var(--gray-400); }
        .balance-amount.balance-high { color: #991B1B; }
        .balance-amount.balance-medium { color: var(--danger); }
        .balance-amount.balance-low { color: var(--warning); }

        .balance-label {
            font-size: 0.75rem;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: var(--radius-full);
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.03em;
        }

        .badge-attorney {
            background: #DC2626;
            color: white;
        }

        .badge-collections {
            background: #991B1B;
            color: white;
        }

        .badge-60days {
            background: var(--danger);
            color: white;
        }

        .badge-30days {
            background: var(--warning);
            color: white;
        }

        .card-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 1rem;
        }

        .tag-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            background: var(--gray-100);
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            color: var(--gray-600);
        }

        .tag-badge.tenant {
            background: var(--info-light);
            color: var(--info);
        }

        .tag-badge.collections-provider {
            background: var(--danger-light);
            color: #991B1B;
        }

        .card-financial {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 1rem;
            padding: 1rem;
            background: var(--gray-50);
            border-radius: var(--radius-sm);
        }

        .financial-item {
            text-align: center;
        }

        .financial-value {
            font-size: 1rem;
            font-weight: 700;
            color: var(--gray-800);
        }

        .financial-value.positive { color: var(--success); }
        .financial-value.negative { color: var(--danger); }

        .financial-label {
            font-size: 0.7rem;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-top: 2px;
        }

        .card-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .detail-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .detail-icon {
            width: 32px;
            height: 32px;
            background: var(--gray-100);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray-500);
            flex-shrink: 0;
        }

        .detail-content {
            flex: 1;
            min-width: 0;
        }

        .detail-label {
            font-size: 0.7rem;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .detail-value {
            font-size: 0.9rem;
            color: var(--gray-800);
            word-break: break-word;
        }

        .detail-value a {
            color: var(--primary);
            text-decoration: none;
        }

        .detail-value a:hover {
            text-decoration: underline;
        }

        .card-actions {
            display: flex;
            gap: 0.75rem;
            padding-top: 1rem;
            border-top: 1px solid var(--gray-200);
        }

        .btn {
            padding: 10px 18px;
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-family: inherit;
            border: none;
            text-decoration: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent-purple) 100%);
            color: white;
        }

        .btn-primary:hover {
            box-shadow: var(--shadow-md), 0 0 20px var(--primary-glow);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--gray-100);
            color: var(--gray-700);
        }

        .btn-secondary:hover {
            background: var(--gray-200);
        }

        /* Document Card */
        .document-card {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: var(--radius);
            padding: 1.5rem;
            position: relative;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .document-card::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 4px;
            height: 100%;
            background: var(--doc-color, #0078d4);
            transition: width 0.3s ease;
        }

        .document-card:hover {
            border-color: var(--gray-300);
            box-shadow: var(--shadow-lg);
            transform: translateY(-4px);
        }

        .document-card:hover::before {
            width: 6px;
        }

        .doc-header {
            display: flex;
            align-items: flex-start;
            gap: 14px;
            margin-bottom: 1rem;
        }

        .doc-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
            flex-shrink: 0;
            background: var(--doc-color, #0078d4);
        }

        .doc-title-section {
            flex: 1;
            min-width: 0;
        }

        .doc-type-label {
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--doc-color, #0078d4);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 4px;
        }

        .doc-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--gray-900);
            line-height: 1.3;
        }

        .doc-community {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 12px;
            background: var(--gray-100);
            border-radius: var(--radius-full);
            font-size: 0.8rem;
            color: var(--gray-600);
            margin-top: 8px;
        }

        .doc-snippet {
            font-size: 0.9rem;
            color: var(--gray-600);
            line-height: 1.6;
            margin-bottom: 1rem;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .doc-snippet mark {
            background: var(--warning-light);
            padding: 0 2px;
            border-radius: 2px;
        }

        .doc-meta {
            display: flex;
            align-items: center;
            gap: 16px;
            font-size: 0.8rem;
            color: var(--gray-500);
            margin-bottom: 1rem;
        }

        .doc-meta-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .doc-actions {
            display: flex;
            gap: 0.75rem;
            padding-top: 1rem;
            border-top: 1px solid var(--gray-200);
        }

        /* Attorney Warning */
        .attorney-warning {
            background: linear-gradient(135deg, #DC2626 0%, #991B1B 100%);
            color: white;
            padding: 1rem;
            border-radius: var(--radius-sm);
            margin-bottom: 1rem;
        }

        .attorney-warning-title {
            font-weight: 700;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .attorney-warning-text {
            font-size: 0.85rem;
            opacity: 0.95;
            line-height: 1.5;
        }

        .attorney-contact {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid rgba(255,255,255,0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .attorney-name {
            font-weight: 600;
        }

        .attorney-phone a {
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .attorney-phone a:hover {
            text-decoration: underline;
        }

        /* Loading States */
        .loading-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 4rem 2rem;
            color: var(--gray-500);
        }

        .loading-spinner {
            width: 48px;
            height: 48px;
            border: 4px solid var(--gray-200);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Skeleton Loading */
        .skeleton {
            background: linear-gradient(90deg, var(--gray-200) 25%, var(--gray-100) 50%, var(--gray-200) 75%);
            background-size: 200% 100%;
            animation: skeleton-loading 1.5s infinite;
            border-radius: var(--radius-sm);
        }

        @keyframes skeleton-loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        .skeleton-card {
            height: 280px;
            border-radius: var(--radius);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--gray-500);
        }

        .empty-state-icon {
            width: 80px;
            height: 80px;
            background: var(--gray-100);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 2rem;
            color: var(--gray-400);
        }

        .empty-state h3 {
            font-size: 1.25rem;
            color: var(--gray-700);
            margin-bottom: 0.5rem;
        }

        .empty-state p {
            font-size: 0.95rem;
            max-width: 400px;
            margin: 0 auto;
        }

        /* Results Sections */
        .results-section {
            margin-bottom: 2rem;
        }

        .results-section:last-child {
            margin-bottom: 0;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--gray-100);
        }

        .section-icon {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: white;
        }

        .section-icon.homeowner { background: linear-gradient(135deg, var(--primary) 0%, var(--accent-purple) 100%); }
        .section-icon.document { background: linear-gradient(135deg, var(--accent-cyan) 0%, #0078d4 100%); }

        .section-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--gray-800);
        }

        .section-count {
            padding: 2px 10px;
            background: var(--gray-100);
            border-radius: var(--radius-full);
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--gray-600);
        }

        /* Card Animations */
        .homeowner-card, .document-card {
            animation: cardFadeIn 0.4s ease-out backwards;
        }

        .results-grid > *:nth-child(1) { animation-delay: 0.05s; }
        .results-grid > *:nth-child(2) { animation-delay: 0.1s; }
        .results-grid > *:nth-child(3) { animation-delay: 0.15s; }
        .results-grid > *:nth-child(4) { animation-delay: 0.2s; }
        .results-grid > *:nth-child(5) { animation-delay: 0.25s; }
        .results-grid > *:nth-child(6) { animation-delay: 0.3s; }

        @keyframes cardFadeIn {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--gray-200);
        }

        .quick-action-btn {
            padding: 10px 18px;
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-full);
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--gray-700);
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quick-action-btn:hover {
            background: var(--primary-light);
            border-color: var(--primary);
            color: var(--primary);
            transform: translateY(-2px);
        }

        .quick-action-btn i {
            font-size: 1rem;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 2rem;
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.875rem;
        }

        .footer a {
            color: white;
            text-decoration: none;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }

            .hero p {
                font-size: 1rem;
            }

            .search-container,
            .results-container {
                padding: 1.5rem;
            }

            .search-mode-toggle {
                flex-wrap: wrap;
            }

            .mode-btn {
                flex: 1;
                justify-content: center;
                min-width: 100px;
            }

            .results-grid {
                grid-template-columns: 1fr;
            }

            .card-header {
                flex-direction: column;
                gap: 1rem;
            }

            .card-balance {
                text-align: left;
            }

            .card-details {
                grid-template-columns: 1fr;
            }

            .card-financial {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .search-btn span {
                display: none;
            }

            .search-hints {
                display: none;
            }
        }

        /* Copy Button */
        .copyable {
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .copy-btn, .text-btn {
            background: none;
            border: none;
            color: var(--gray-400);
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .copy-btn:hover, .text-btn:hover {
            color: var(--primary);
            background: var(--primary-light);
        }
    </style>
</head>
<body>
    <!-- Background -->
    <div class="bg-gradient"></div>
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="orb orb-3"></div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <a href="/" class="logo">
                <div class="logo-icon">
                    <i class="fas fa-wand-magic-sparkles"></i>
                </div>
                <div class="logo-text">
                    <span class="logo-title">Manager Wizard</span>
                    <span class="logo-subtitle">PS PROPERTY MANAGEMENT</span>
                </div>
            </a>
            <div class="status-indicator" id="statusIndicator">
                <span class="status-dot"></span>
                <span id="statusText">Connected</span>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Hero -->
        <section class="hero">
            <h1>Ask me anything</h1>
            <p>Search homeowners by phone, address, or name. Ask questions about community rules and policies.</p>
        </section>

        <!-- Search Container -->
        <div class="search-container">
            <!-- Mode Toggle -->
            <div class="search-mode-toggle">
                <button class="mode-btn active" data-mode="auto">
                    <i class="fas fa-wand-magic-sparkles"></i>
                    <span>Auto-detect</span>
                </button>
                <button class="mode-btn" data-mode="homeowner">
                    <i class="fas fa-user"></i>
                    <span>Homeowners</span>
                </button>
                <button class="mode-btn" data-mode="document">
                    <i class="fas fa-file-alt"></i>
                    <span>Documents</span>
                </button>
                <button class="mode-btn" data-mode="both">
                    <i class="fas fa-layer-group"></i>
                    <span>Both</span>
                </button>
            </div>

            <!-- Search Box -->
            <div class="search-box">
                <input type="text"
                       class="search-input"
                       id="searchInput"
                       placeholder="Search by phone, address, name, or ask a question..."
                       autocomplete="off">
                <i class="fas fa-search search-icon"></i>
                <button class="search-btn" id="searchBtn">
                    <i class="fas fa-arrow-right"></i>
                    <span>Search</span>
                </button>
            </div>

            <!-- Search Hints -->
            <div class="search-hints">
                <span class="hint-chip" data-query="512-555-1234"><i class="fas fa-phone"></i>Phone</span>
                <span class="hint-chip" data-query="7016 Walkup Lane"><i class="fas fa-map-marker-alt"></i>Address</span>
                <span class="hint-chip" data-query="fence height Falcon Pointe"><i class="fas fa-border-all"></i>Fence Rules</span>
                <span class="hint-chip" data-query="pool rules Vista Vera"><i class="fas fa-swimming-pool"></i>Pool Rules</span>
                <span class="hint-chip" data-query="parking policy"><i class="fas fa-car"></i>Parking</span>
                <span class="hint-chip" data-query="pet restrictions"><i class="fas fa-paw"></i>Pets</span>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <button class="quick-action-btn" data-community="Falcon Pointe">
                    <i class="fas fa-building"></i> Falcon Pointe
                </button>
                <button class="quick-action-btn" data-community="Avalon">
                    <i class="fas fa-building"></i> Avalon
                </button>
                <button class="quick-action-btn" data-community="Chandler Creek">
                    <i class="fas fa-building"></i> Chandler Creek
                </button>
                <button class="quick-action-btn" data-community="Heritage Park">
                    <i class="fas fa-building"></i> Heritage Park
                </button>
                <button class="quick-action-btn" data-community="Vista Vera">
                    <i class="fas fa-building"></i> Vista Vera
                </button>
            </div>
        </div>

        <!-- Results Container -->
        <div class="results-container" id="resultsContainer" style="display: none;">
            <div id="resultsContent"></div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>PS Property Management • Serving Central Texas communities since 1987 • <a href="tel:512-251-6122">512-251-6122</a></p>
    </footer>

    <script>
        // State
        let currentMode = 'auto';
        let isSearching = false;

        // Elements
        const searchInput = document.getElementById('searchInput');
        const searchBtn = document.getElementById('searchBtn');
        const resultsContainer = document.getElementById('resultsContainer');
        const resultsContent = document.getElementById('resultsContent');
        const statusIndicator = document.getElementById('statusIndicator');
        const statusText = document.getElementById('statusText');

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            checkStatus();
            setupEventListeners();
        });

        function setupEventListeners() {
            // Mode toggle
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentMode = btn.dataset.mode;
                    updatePlaceholder();
                });
            });

            // Search
            searchBtn.addEventListener('click', performSearch);
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') performSearch();
            });

            // Hint chips
            document.querySelectorAll('.hint-chip').forEach(chip => {
                chip.addEventListener('click', () => {
                    searchInput.value = chip.dataset.query;
                    performSearch();
                });
            });

            // Quick action buttons
            document.querySelectorAll('.quick-action-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    searchInput.value = btn.dataset.community;
                    currentMode = 'homeowner';
                    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
                    document.querySelector('.mode-btn[data-mode="homeowner"]').classList.add('active');
                    performSearch();
                });
            });
        }

        function updatePlaceholder() {
            const placeholders = {
                'auto': 'Search by phone, address, name, or ask a question...',
                'homeowner': 'Search homeowners by phone, address, or name...',
                'document': 'Ask about community rules and policies...',
                'both': 'Search everything...'
            };
            searchInput.placeholder = placeholders[currentMode] || placeholders['auto'];
        }

        async function checkStatus() {
            try {
                const resp = await fetch('/api/status');
                const data = await resp.json();

                if (data.status === 'connected') {
                    statusIndicator.querySelector('.status-dot').classList.remove('disconnected');
                    statusText.textContent = `Connected • ${data.record_count} homeowners`;
                    if (data.azure_search === 'configured') {
                        statusText.textContent += ` • ${data.documents_indexed} docs`;
                    }
                } else {
                    statusIndicator.querySelector('.status-dot').classList.add('disconnected');
                    statusText.textContent = 'Disconnected';
                }
            } catch (error) {
                statusIndicator.querySelector('.status-dot').classList.add('disconnected');
                statusText.textContent = 'Connection error';
            }
        }

        async function performSearch() {
            const query = searchInput.value.trim();
            if (!query || isSearching) return;

            isSearching = true;
            searchBtn.disabled = true;
            resultsContainer.style.display = 'block';

            // Show loading
            resultsContent.innerHTML = `
                <div class="loading-state">
                    <div class="loading-spinner"></div>
                    <p>Searching...</p>
                </div>
            `;

            try {
                const resp = await fetch(`/api/unified-search?q=${encodeURIComponent(query)}&mode=${currentMode}`);
                const data = await resp.json();

                if (data.error) {
                    showError(data.error);
                    return;
                }

                renderResults(data);
            } catch (error) {
                showError('Search failed. Please try again.');
                console.error('Search error:', error);
            } finally {
                isSearching = false;
                searchBtn.disabled = false;
            }
        }

        function showError(message) {
            resultsContent.innerHTML = `
                <div class="empty-state">
                    <div class="empty-state-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <h3>Oops!</h3>
                    <p>${escapeHtml(message)}</p>
                </div>
            `;
        }

        function renderResults(data) {
            const hasHomeowners = data.homeowners && data.homeowners.length > 0;
            const hasDocuments = data.documents && data.documents.length > 0;
            const hasAiAnswer = data.ai_answer && data.ai_answer.extracted;

            if (!hasHomeowners && !hasDocuments) {
                resultsContent.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">
                            <i class="fas fa-search"></i>
                        </div>
                        <h3>No results found</h3>
                        <p>Try a different search term or adjust your search mode.</p>
                    </div>
                `;
                return;
            }

            let html = '';

            // Results header
            html += `
                <div class="results-header">
                    <div class="results-title">
                        <i class="fas fa-sparkles"></i>
                        Results for "${escapeHtml(data.query)}"
                    </div>
                    <span class="detected-badge">
                        <i class="fas fa-wand-magic-sparkles"></i>
                        ${data.detected_type === 'homeowner' ? 'Homeowner Search' :
                          data.detected_type === 'document' ? 'Document Search' : 'Combined Search'}
                    </span>
                </div>
            `;

            // AI Answer Card (if available)
            if (hasAiAnswer) {
                html += renderAiAnswerCard(data.ai_answer, data.community_detected);
            }

            // Homeowner Results
            if (hasHomeowners) {
                html += `
                    <div class="results-section">
                        <div class="section-header">
                            <div class="section-icon homeowner">
                                <i class="fas fa-user"></i>
                            </div>
                            <span class="section-title">Homeowners</span>
                            <span class="section-count">${data.homeowners.length}</span>
                        </div>
                        <div class="results-grid">
                            ${data.homeowners.map(h => renderHomeownerCard(h)).join('')}
                        </div>
                    </div>
                `;
            }

            // Document Results
            if (hasDocuments) {
                html += `
                    <div class="results-section">
                        <div class="section-header">
                            <div class="section-icon document">
                                <i class="fas fa-file-alt"></i>
                            </div>
                            <span class="section-title">Documents</span>
                            <span class="section-count">${data.documents.length}</span>
                        </div>
                        <div class="results-grid">
                            ${data.documents.map(d => renderDocumentCard(d)).join('')}
                        </div>
                    </div>
                `;
            }

            resultsContent.innerHTML = html;
        }

        function renderAiAnswerCard(aiAnswer, community) {
            const extracted = aiAnswer.extracted;
            const type = aiAnswer.extraction_type;

            if (extracted.not_found) {
                return `
                    <div class="ai-answer-card" style="border-color: var(--warning);">
                        <div class="ai-answer-header">
                            <div class="ai-icon" style="background: linear-gradient(135deg, var(--warning) 0%, var(--accent-orange) 100%);">
                                <i class="fas fa-question"></i>
                            </div>
                            <div>
                                <div class="ai-answer-title">Information Not Found</div>
                                <div class="ai-answer-subtitle">Couldn't find a specific answer in the documents</div>
                            </div>
                        </div>
                        <div class="ai-summary">${escapeHtml(extracted.suggestion || 'Try searching with different keywords.')}</div>
                    </div>
                `;
            }

            let contentHtml = '';

            // Type-specific rendering
            if (type === 'fence' && extracted.max_height_back) {
                contentHtml = `
                    <div class="ai-answer-content">
                        <div class="ai-data-item">
                            <span class="ai-data-label">Max Height (Backyard)</span>
                            <span class="ai-data-value">${escapeHtml(extracted.max_height_back)}</span>
                        </div>
                        <div class="ai-data-item">
                            <span class="ai-data-label">Max Height (Front)</span>
                            <span class="ai-data-value">${escapeHtml(extracted.max_height_front || 'N/A')}</span>
                        </div>
                        <div class="ai-data-item">
                            <span class="ai-data-label">ARC Required</span>
                            <span class="ai-data-value">${extracted.arc_required ? '✅ Yes' : '❌ No'}</span>
                        </div>
                    </div>
                    ${extracted.approved_materials ? `
                        <div class="ai-tags">
                            ${extracted.approved_materials.map(m => `<span class="ai-tag">${escapeHtml(m)}</span>`).join('')}
                        </div>
                    ` : ''}
                `;
            } else if (type === 'pool' && extracted.hours) {
                contentHtml = `
                    <div class="ai-answer-content">
                        <div class="ai-data-item">
                            <span class="ai-data-label">Pool Hours</span>
                            <span class="ai-data-value">${escapeHtml(extracted.hours)}</span>
                        </div>
                        <div class="ai-data-item">
                            <span class="ai-data-label">Guest Policy</span>
                            <span class="ai-data-value">${escapeHtml(extracted.guest_policy || 'See rules')}</span>
                        </div>
                    </div>
                    ${extracted.key_rules ? `
                        <div class="ai-tags">
                            ${extracted.key_rules.map(r => `<span class="ai-tag">${escapeHtml(r)}</span>`).join('')}
                        </div>
                    ` : ''}
                `;
            } else if (extracted.key_points) {
                contentHtml = `
                    <div class="ai-tags">
                        ${extracted.key_points.map(p => `<span class="ai-tag">${escapeHtml(p)}</span>`).join('')}
                    </div>
                `;
            }

            return `
                <div class="ai-answer-card">
                    <div class="ai-answer-header">
                        <div class="ai-icon">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div>
                            <div class="ai-answer-title">AI-Extracted Answer</div>
                            <div class="ai-answer-subtitle">${community ? `For ${escapeHtml(community)}` : 'From community documents'}</div>
                        </div>
                    </div>
                    ${contentHtml}
                    ${extracted.summary ? `<div class="ai-summary">${escapeHtml(extracted.summary)}</div>` : ''}
                    ${extracted.answer ? `<div class="ai-summary">${escapeHtml(extracted.answer)}</div>` : ''}
                </div>
            `;
        }

        function renderHomeownerCard(h) {
            const isAttorney = h.collection_status && h.collection_status.toLowerCase().includes('attorney');

            let cardClass = 'homeowner-card';
            if (isAttorney) {
                cardClass += ' status-attorney';
            } else if (h.collection_indicator === 'collections') {
                cardClass += ' status-collections';
            } else if (h.balance_status === 'owed') {
                cardClass += ' status-owed';
            } else if (h.balance_status === 'credit') {
                cardClass += ' status-credit';
            }

            let statusBadge = '';
            if (isAttorney) {
                statusBadge = '<span class="status-badge badge-attorney">⚠️ ATTORNEY</span>';
            } else if (h.collection_indicator === 'collections') {
                statusBadge = '<span class="status-badge badge-collections">In Collections</span>';
            } else if (h.collection_indicator === '60_days') {
                statusBadge = '<span class="status-badge badge-60days">60+ Days</span>';
            } else if (h.collection_indicator === '30_days') {
                statusBadge = '<span class="status-badge badge-30days">30+ Days</span>';
            }

            let balanceClass = 'balance-current';
            if (h.balance > 1000) balanceClass = 'balance-high';
            else if (h.balance > 500) balanceClass = 'balance-medium';
            else if (h.balance > 0) balanceClass = 'balance-low';
            else if (h.balance_status === 'credit') balanceClass = 'balance-credit';

            // Tags
            let tagsHtml = '';
            if (h.tenant_name || h.collection_provider || h.unit_lot) {
                tagsHtml = '<div class="card-tags">';
                if (h.tenant_name) {
                    tagsHtml += `<span class="tag-badge tenant"><i class="fas fa-user-friends"></i> Tenant: ${escapeHtml(h.tenant_name)}</span>`;
                }
                if (h.collection_provider) {
                    tagsHtml += `<span class="tag-badge collections-provider"><i class="fas fa-gavel"></i> ${escapeHtml(h.collection_provider)}</span>`;
                }
                if (h.unit_lot) {
                    tagsHtml += `<span class="tag-badge"><i class="fas fa-door-open"></i> ${escapeHtml(h.unit_lot)}</span>`;
                }
                tagsHtml += '</div>';
            }

            // Financial section
            let financialHtml = '';
            if (h.last_payment && !isAttorney) {
                financialHtml = `
                    <div class="card-financial">
                        <div class="financial-item">
                            <div class="financial-value ${h.balance > 0 ? 'negative' : (h.balance_status === 'credit' ? 'positive' : '')}">${escapeHtml(h.balance_display)}</div>
                            <div class="financial-label">Balance</div>
                        </div>
                        <div class="financial-item">
                            <div class="financial-value positive">${escapeHtml(h.last_payment.amount)}</div>
                            <div class="financial-label">Last Payment</div>
                        </div>
                        <div class="financial-item">
                            <div class="financial-value">${escapeHtml(h.last_payment.date)}</div>
                            <div class="financial-label">Payment Date</div>
                        </div>
                    </div>
                `;
            }

            // Attorney warning
            let attorneyWarningHtml = '';
            if (isAttorney) {
                attorneyWarningHtml = `
                    <div class="attorney-warning">
                        <div class="attorney-warning-title">
                            <i class="fas fa-exclamation-triangle"></i>
                            ACCOUNT WITH ATTORNEY
                        </div>
                        <div class="attorney-warning-text">
                            This account has been referred to an attorney for collections.<br>
                            <strong>Do NOT discuss balance or payment details with the homeowner.</strong>
                        </div>
                        ${h.collection_provider ? `
                            <div class="attorney-contact">
                                <div class="attorney-name">${escapeHtml(h.collection_provider)}</div>
                            </div>
                        ` : ''}
                    </div>
                `;
            }

            // Balance header (hide for attorney)
            const balanceHeaderHtml = isAttorney ? '' : `
                <div class="card-balance">
                    <div class="balance-amount ${balanceClass}">${escapeHtml(h.balance_display)}</div>
                    <div class="balance-label">${h.balance_status === 'credit' ? 'Credit Balance' : 'Balance'}</div>
                </div>
            `;

            return `
                <div class="${cardClass}">
                    <div class="card-header">
                        <div>
                            <div class="card-name">${escapeHtml(h.owner_name)}</div>
                            <div class="card-community">${escapeHtml(h.community)}</div>
                            ${statusBadge}
                        </div>
                        ${balanceHeaderHtml}
                    </div>
                    ${attorneyWarningHtml}
                    ${tagsHtml}
                    ${financialHtml}
                    <div class="card-details">
                        <div class="detail-item">
                            <div class="detail-icon"><i class="fas fa-map-marker-alt"></i></div>
                            <div class="detail-content">
                                <div class="detail-label">Address</div>
                                <div class="detail-value">${escapeHtml(h.property_address)}</div>
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-icon"><i class="fas fa-phone"></i></div>
                            <div class="detail-content">
                                <div class="detail-label">Phone</div>
                                <div class="detail-value">
                                    ${h.phone !== 'N/A' ? `<a href="tel:${h.phone}">${escapeHtml(h.phone)}</a>` : 'N/A'}
                                </div>
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-icon"><i class="fas fa-envelope"></i></div>
                            <div class="detail-content">
                                <div class="detail-label">Email</div>
                                <div class="detail-value">
                                    ${h.email !== 'N/A' ? `<a href="mailto:${h.email}">${escapeHtml(h.email)}</a>` : 'N/A'}
                                </div>
                            </div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-icon"><i class="fas fa-hashtag"></i></div>
                            <div class="detail-content">
                                <div class="detail-label">Account</div>
                                <div class="detail-value">${escapeHtml(h.account_number)}</div>
                            </div>
                        </div>
                    </div>
                    <div class="card-actions">
                        ${h.vantaca_url ? `
                            <a href="${escapeHtml(h.vantaca_url)}" target="_blank" class="btn btn-primary">
                                <i class="fas fa-external-link-alt"></i> Open in Vantaca
                            </a>
                        ` : ''}
                        <button class="btn btn-secondary" onclick="copyToClipboard('${escapeHtml(h.phone)}')">
                            <i class="fas fa-copy"></i> Copy Phone
                        </button>
                    </div>
                </div>
            `;
        }

        function renderDocumentCard(doc) {
            const typeInfo = doc.doc_type_info || { icon: 'file-alt', color: '#0078d4', label: 'Document' };

            // Get snippet from captions or content
            let snippet = '';
            if (doc.captions && doc.captions.length > 0) {
                snippet = doc.captions[0].text || doc.captions[0].highlights || '';
            } else if (doc.content_snippet) {
                snippet = doc.content_snippet.substring(0, 200) + '...';
            }

            // Format date
            let dateStr = '';
            if (doc.last_modified) {
                try {
                    const date = new Date(doc.last_modified);
                    dateStr = date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
                } catch (e) {
                    dateStr = '';
                }
            }

            // Decode SharePoint URL if needed
            let sharePointUrl = '';
            if (doc.path) {
                try {
                    // The path is usually base64 encoded
                    const decoded = atob(doc.path.replace('aHR0cHM6Ly9wc3Byb3Auc2hhcmVwb2ludC5jb20v', ''));
                    sharePointUrl = 'https://psprop.sharepoint.com/' + decoded;
                } catch (e) {
                    sharePointUrl = doc.path;
                }
            }

            return `
                <div class="document-card" style="--doc-color: ${typeInfo.color}">
                    <div class="doc-header">
                        <div class="doc-icon" style="background: ${typeInfo.color}">
                            <i class="fas fa-${typeInfo.icon}"></i>
                        </div>
                        <div class="doc-title-section">
                            <div class="doc-type-label">${escapeHtml(typeInfo.label)}</div>
                            <div class="doc-title">${escapeHtml(doc.title)}</div>
                            ${doc.community ? `
                                <div class="doc-community">
                                    <i class="fas fa-building"></i>
                                    ${escapeHtml(doc.community)}
                                </div>
                            ` : ''}
                        </div>
                    </div>
                    ${snippet ? `<div class="doc-snippet">${snippet}</div>` : ''}
                    <div class="doc-meta">
                        ${dateStr ? `
                            <div class="doc-meta-item">
                                <i class="fas fa-calendar"></i>
                                ${dateStr}
                            </div>
                        ` : ''}
                        <div class="doc-meta-item">
                            <i class="fas fa-star"></i>
                            ${doc.score ? doc.score.toFixed(2) : 'N/A'} relevance
                        </div>
                    </div>
                    <div class="doc-actions">
                        <a href="${escapeHtml(sharePointUrl)}" target="_blank" class="btn btn-primary">
                            <i class="fas fa-external-link-alt"></i> View in SharePoint
                        </a>
                        <button class="btn btn-secondary" onclick="copyToClipboard('${escapeHtml(doc.title)}')">
                            <i class="fas fa-copy"></i> Copy Title
                        </button>
                    </div>
                </div>
            `;
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                // Could add a toast notification here
                console.log('Copied:', text);
            });
        }

        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
    </script>
</body>
</html>
